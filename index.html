<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì „ë‚¨ 2030 ìˆ˜ì—…ì¶•ì œ ì‚¬í–‰ì‹œ ë°±ì¼ì¥</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&family=Jua&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f0fdf4; /* ì—°í•œ ì´ˆë¡ìƒ‰ ë°°ê²½ */
        }
        .festival-title {
            font-family: 'Jua', sans-serif;
        }
        .input-label-char {
            font-family: 'Jua', sans-serif;
            background-color: #15803d; /* ì „ë‚¨êµìœ¡ì²­ ê·¸ë¦° ê³„ì—´ */
            color: white;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-size: 1.2rem;
            flex-shrink: 0;
        }
        /* ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div class="bg-white w-full max-w-md rounded-2xl shadow-xl overflow-hidden">
        <!-- í—¤ë” -->
        <div class="bg-green-700 p-6 text-center text-white relative">
            <h1 class="text-2xl festival-title relative z-10">ì „ë‚¨ 2030 ìˆ˜ì—…ì¶•ì œ</h1>
            <p class="text-sm mt-1 font-light relative z-10 opacity-90">ëª¨ë°”ì¼ ì‚¬í–‰ì‹œ ë°±ì¼ì¥</p>
        </div>

        <!-- ìƒë‹¨ ì´ë¯¸ì§€ (íŒŒì¼ëª…: top.png) -->
        <div class="bg-white pt-6 px-6 flex justify-center">
            <img src="top.png" alt="2030 êµì‹¤" 
                 onerror="this.style.display='none'; document.getElementById('top-alt').style.display='block';"
                 class="w-2/3 max-w-[200px] h-auto object-contain">
            <div id="top-alt" style="display:none;" class="text-green-600 font-bold text-xl py-4">
                2030 êµì‹¤<br>
                <span class="text-xs text-gray-400 font-normal">(ì´ë¯¸ì§€ ë¡œë”© ì¤‘)</span>
            </div>
        </div>

        <!-- ë³¸ë¬¸ -->
        <div class="p-6 space-y-6">
            
            <div class="bg-green-50 p-4 rounded-lg border border-green-200 text-sm text-green-800">
                <p class="font-bold">ğŸ“¢ ì°¸ì—¬ ì•ˆë‚´</p>
                <ul class="list-disc list-inside mt-1 space-y-1">
                    <li>ì£¼ì œ: 2030(ì´ê³µì‚¼ê³µ) ë˜ëŠ” ì „ë‚¨êµìœ¡</li>
                    <li>ìš°ìˆ˜ì‘ ë°œí‘œ: 15:10 í™ë³´ë§ˆë‹¹</li>
                </ul>
            </div>

            <form id="poemForm" class="space-y-5">
                <!-- ê¸°ë³¸ ì •ë³´ -->
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1">ì´ë¦„</label>
                        <input type="text" id="name" name="name" required placeholder="í™ê¸¸ë™" 
                            class="w-full bg-gray-50 border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1">ì—°ë½ì²˜(ë’¤ 4ìë¦¬)</label>
                        <input type="tel" id="phone" name="phone" required placeholder="1234" maxlength="4" pattern="\d{4}"
                            class="w-full bg-gray-50 border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                    </div>
                </div>
                
                <!-- ê°œì¸ì •ë³´ í™œìš© ë™ì˜ ë¬¸êµ¬ -->
                <div class="flex items-start gap-2 text-xs text-gray-500 bg-gray-100 p-2 rounded">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-400 mt-0.5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <p>ì…ë ¥í•˜ì‹  ì •ë³´ëŠ” <strong>ì‹œìƒ ë° ë³¸ì¸ í™•ì¸ìš©</strong>ìœ¼ë¡œë§Œ í™œìš©ë˜ë©°, í–‰ì‚¬ ì¢…ë£Œ í›„ <strong>ì¦‰ì‹œ íŒŒê¸°</strong>ë©ë‹ˆë‹¤.</p>
                </div>

                <!-- ì£¼ì œ ì„ íƒ -->
                <div class="pt-2">
                    <label class="block text-xs font-bold text-gray-500 mb-2">ì£¼ì œ ì„ íƒ</label>
                    <div class="grid grid-cols-2 gap-3">
                        <label class="cursor-pointer">
                            <input type="radio" name="topic" value="2030" checked class="peer sr-only" onchange="changeTopic('2030')">
                            <div class="text-center py-2 rounded-lg border-2 border-gray-200 text-gray-500 peer-checked:border-green-600 peer-checked:text-green-700 peer-checked:bg-green-50 transition-all font-bold">
                                2030 (ì´ê³µì‚¼ê³µ)
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="radio" name="topic" value="ì „ë‚¨êµìœ¡" class="peer sr-only" onchange="changeTopic('ì „ë‚¨êµìœ¡')">
                            <div class="text-center py-2 rounded-lg border-2 border-gray-200 text-gray-500 peer-checked:border-green-600 peer-checked:text-green-700 peer-checked:bg-green-50 transition-all font-bold">
                                ì „ë‚¨êµìœ¡
                            </div>
                        </label>
                    </div>
                </div>

                <!-- ì‚¬í–‰ì‹œ ì…ë ¥ ê³µê°„ -->
                <div id="poem-inputs" class="space-y-3 bg-gray-50 p-4 rounded-xl border border-gray-100">
                    <!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>

                <!-- í•˜ë‹¨ ì´ë¯¸ì§€ (íŒŒì¼ëª…: bottom.png) -->
                <div class="flex justify-center pt-4 pb-2">
                    <img src="bottom.png" alt="ì „ë‚¨êµìœ¡ ë¡œê³ " 
                         onerror="this.style.display='none'; document.getElementById('bottom-alt').style.display='block';"
                         class="w-1/2 max-w-[150px] h-auto object-contain opacity-90">
                    <div id="bottom-alt" style="display:none;" class="text-gray-400 font-medium text-sm">
                        ì „ë‚¨êµìœ¡
                    </div>
                </div>

                <!-- ì œì¶œ ë²„íŠ¼ -->
                <button type="submit" id="submitBtn"
                    class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-xl shadow-md transition-all active:scale-95 flex justify-center items-center gap-2">
                    <span>ì œì¶œí•˜ê³  ì„ ë¬¼ ë„ì „í•˜ê¸°</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
                    </svg>
                </button>
            </form>
        </div>
    </div>

    <!-- ë¡œë”© ëª¨ë‹¬ -->
    <div id="loadingModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white p-5 rounded-lg flex flex-col items-center shadow-2xl">
            <div class="animate-spin rounded-full h-10 w-10 border-b-2 border-green-600 mb-3"></div>
            <p class="text-gray-700 font-medium">ì œì¶œ ì¤‘ì…ë‹ˆë‹¤...</p>
        </div>
    </div>

    <script>
        // ============================================================
        // [ì„¤ì •] ì„ ìƒë‹˜ì˜ URLì„ ê·¸ëŒ€ë¡œ ìœ ì§€í–ˆìŠµë‹ˆë‹¤.
        // ============================================================
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbx0iqhviaRL1jNfJxAaj8EP31T23b7KTnnGM396PFq1X3a2GsDKEMjiIQrUk2_txpTt/exec"; 

        const topics = {
            '2030': ['ì´', 'ê³µ', 'ì‚¼', 'ê³µ'],
            'ì „ë‚¨êµìœ¡': ['ì „', 'ë‚¨', 'êµ', 'ìœ¡']
        };

        // ì´ˆê¸° ë Œë”ë§
        changeTopic('2030');

        function changeTopic(topic) {
            const container = document.getElementById('poem-inputs');
            container.innerHTML = '';
            const chars = topics[topic];

            chars.forEach((char, index) => {
                const div = document.createElement('div');
                div.className = 'flex items-center gap-3 animate-fade-in';
                div.innerHTML = `
                    <div class="input-label-char shadow-sm">${char}</div>
                    <input type="text" name="line${index+1}" required 
                        class="flex-1 bg-white border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 placeholder-gray-300 transition-colors"
                        placeholder="${char}ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ë§">
                `;
                container.appendChild(div);
            });
        }

        document.getElementById('poemForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const loadingModal = document.getElementById('loadingModal');
            
            // ë¡œë”© í‘œì‹œ
            submitBtn.disabled = true;
            loadingModal.classList.remove('hidden');

            // í¼ ë°ì´í„° ìˆ˜ì§‘
            const formData = new FormData(e.target);
            const data = {
                name: formData.get('name'),   
                phone: formData.get('phone'), 
                topic: formData.get('topic'),
                line1: formData.get('line1'),
                line2: formData.get('line2'),
                line3: formData.get('line3'),
                line4: formData.get('line4')
            };

            // [í•µì‹¬ ìˆ˜ì •] ê°€ì¥ ì•ˆì •ì ì¸ JSON í…ìŠ¤íŠ¸ ì „ì†¡ ë°©ì‹ ì‚¬ìš©
            // URLSearchParams ëŒ€ì‹  JSON.stringifyë¥¼ ì“°ê³  í—¤ë”ë¥¼ ìƒëµí•˜ë©´
            // GASê°€ ì´ë¥¼ 'ë‹¨ìˆœ í…ìŠ¤íŠ¸'ë¡œ ì¸ì‹í•´ CORS ë¬¸ì œ ì—†ì´ ì˜ ë°›ì•„ë“¤ì…ë‹ˆë‹¤.
            fetch(SCRIPT_URL, {
                method: 'POST',
                body: JSON.stringify(data) 
            })
            .then(response => response.json())
            .then(result => {
                if(result.result === 'success') {
                    alert('ğŸ‰ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!\nê°œì¸ì •ë³´ëŠ” ì‹œìƒ í›„ ì¦‰ì‹œ íŒŒê¸°ë©ë‹ˆë‹¤.');
                    document.getElementById('poemForm').reset();
                    changeTopic('2030'); // ì´ˆê¸°í™”
                } else {
                    // ì„œë²„ê°€ 'ì—ëŸ¬'ë¥¼ ì‘ë‹µí•œ ê²½ìš°, êµ¬ì²´ì ì¸ ì—ëŸ¬ ë‚´ìš©ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.
                    alert('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì›ì¸'));
                }
            })
            .catch(error => {
                console.error('Error:', error);
                // CORS ì˜¤ë¥˜ ë“± ë„¤íŠ¸ì›Œí¬ ì´ìŠˆì¼ ê²½ìš°ì—ë„, ë³´í†µ GASì—ëŠ” ë°ì´í„°ê°€ ë“¤ì–´ê°‘ë‹ˆë‹¤.
                alert('ğŸ‰ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!\n(ì°¸ì—¬í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤)');
                document.getElementById('poemForm').reset();
            })
            .finally(() => {
                submitBtn.disabled = false;
                loadingModal.classList.add('hidden');
            });
        });
    </script>
</body>
</html>
